# =============================================================================
# THE ETERNAL ENGINE - Environment Configuration
# =============================================================================
# This file contains all environment variables needed to run the Eternal Engine.
# Copy this file to .env and fill in your actual values.
# NEVER commit .env files with real credentials to version control.
# =============================================================================

# =============================================================================
# 1. SYSTEM CONFIGURATION
# =============================================================================

# Environment: development, staging, or production
ENVIRONMENT=development

# Application name and version
APP_NAME="The Eternal Engine"
APP_VERSION=1.0.0

# Timezone for all operations (default: UTC)
TIMEZONE=UTC

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Dry run mode - set to true to simulate trades without execution
DRY_RUN=true

# Auto-restart on critical errors
AUTO_RESTART=true

# =============================================================================
# 2. TRADING MODE & EXCHANGE CONFIGURATION
# =============================================================================

# Trading mode: paper (simulation) or live (real trading)
TRADING_MODE=paper

# Bybit API version and settings
BYBIT_API_VERSION=v5
BYBIT_TESTNET=true
BYBIT_TIMEOUT=30
BYBIT_RETRY_ATTEMPTS=3
BYBIT_RATE_LIMIT_REST=120
BYBIT_RATE_LIMIT_WEBSOCKET=1000

# =============================================================================
# 3. BYBIT API KEYS - DEMO vs PROD MODE
# =============================================================================
# The system supports two modes: DEMO (testnet/paper) and PROD (live).
# Set BYBIT_API_MODE to "demo" or "prod" to switch between them.
# =============================================================================

# API Mode: "demo" for testnet/paper trading, "prod" for live trading
BYBIT_API_MODE=demo

# --- DEMO API Keys (Testnet - Read/Write) ---
# Use these for paper trading and testing on Bybit Testnet
BYBIT_DEMO_API_KEY=hyDYLLz8FWyTABq620
BYBIT_DEMO_API_SECRET=bUh5xWS8aXVmARXa7Bj5AC6jliuOfCfTyshP

# --- PROD API Keys (Live - Read Only for now) ---
# Use these for live trading on Bybit Mainnet
# NOTE: PROD keys are currently read-only. Enable write access when ready.
BYBIT_PROD_API_KEY=JInCGmyvTA82F4OSnY
BYBIT_PROD_API_SECRET=wpIbDFs9PKmUJ0xG8O2vv6FmTuVuAmD0BU3d

# =============================================================================
# 4. BYBIT API KEYS - SUBACCOUNTS (5 Subaccounts)
# =============================================================================
# Each engine operates in its own subaccount for isolation.
# Create these subaccounts in your Bybit account and generate API keys.
# These are used when BYBIT_API_MODE is not set (legacy mode)
# =============================================================================

# --- MASTER Subaccount (Read-only monitoring) ---
BYBIT_MASTER_API_KEY=your_master_api_key_here
BYBIT_MASTER_API_SECRET=your_master_api_secret_here

# --- CORE-HODL Subaccount (60% allocation) ---
BYBIT_CORE_HODL_API_KEY=your_core_hodl_api_key_here
BYBIT_CORE_HODL_API_SECRET=your_core_hodl_api_secret_here

# --- TREND-1 Subaccount (20% allocation) ---
BYBIT_TREND_1_API_KEY=your_trend_1_api_key_here
BYBIT_TREND_1_API_SECRET=your_trend_1_api_secret_here

# --- FUNDING Subaccount (15% allocation) ---
BYBIT_FUNDING_API_KEY=your_funding_api_key_here
BYBIT_FUNDING_API_SECRET=your_funding_api_secret_here

# --- TACTICAL Subaccount (5% allocation) ---
BYBIT_TACTICAL_API_KEY=your_tactical_api_key_here
BYBIT_TACTICAL_API_SECRET=your_tactical_api_secret_here

# =============================================================================
# 5. CAPITAL ALLOCATION PER ENGINE
# =============================================================================

# Percentage allocation of total portfolio (must sum to 1.0)
ALLOCATION_CORE_HODL=0.60
ALLOCATION_TREND=0.20
ALLOCATION_FUNDING=0.15
ALLOCATION_TACTICAL=0.05

# =============================================================================
# 6. DEFAULT TRADING SYMBOLS
# =============================================================================

# Primary trading pairs (comma-separated)
DEFAULT_SYMBOLS=BTCUSDT,ETHUSDT

# Perpetual futures symbols
PERP_SYMBOLS=BTC-PERP,ETH-PERP

# =============================================================================
# 7. RISK MANAGEMENT - CIRCUIT BREAKERS
# =============================================================================

# Level 1: CAUTION (10% drawdown) - Reduce positions 25%
CIRCUIT_BREAKER_1_THRESHOLD=0.10
CIRCUIT_BREAKER_1_ACTION=reduce_position_size
CIRCUIT_BREAKER_1_REDUCTION=0.25

# Level 2: WARNING (15% drawdown) - Reduce 50%, pause entries
CIRCUIT_BREAKER_2_THRESHOLD=0.15
CIRCUIT_BREAKER_2_ACTION=reduce_and_pause
CIRCUIT_BREAKER_2_REDUCTION=0.50

# Level 3: ALERT (20% drawdown) - Close directional, halt trading
CIRCUIT_BREAKER_3_THRESHOLD=0.20
CIRCUIT_BREAKER_3_ACTION=close_directional
CIRCUIT_BREAKER_3_HALT_TRADING=true

# Level 4: EMERGENCY (25% drawdown) - Full liquidation
CIRCUIT_BREAKER_4_THRESHOLD=0.25
CIRCUIT_BREAKER_4_ACTION=emergency_liquidation
CIRCUIT_BREAKER_4_HALT_TRADING=true

# =============================================================================
# 8. POSITION SIZING & LEVERAGE
# =============================================================================

# Kelly Criterion fraction (1/8 Kelly = 0.125)
KELLY_FRACTION=0.125

# Maximum risk per trade (% of portfolio)
MAX_RISK_PER_TRADE=0.01

# Maximum position size (% of portfolio per position)
MAX_POSITION_PCT=0.05

# Maximum leverage (2.0 for TREND/FUNDING, 1.0 for CORE/TACTICAL)
MAX_LEVERAGE=2.0

# Maximum daily loss limit (% of portfolio)
MAX_DAILY_LOSS_PCT=0.02

# Maximum weekly loss limit (% of portfolio)
MAX_WEEKLY_LOSS_PCT=0.05

# Maximum concurrent positions
MAX_CONCURRENT_POSITIONS=3

# =============================================================================
# 9. CORE-HODL ENGINE SETTINGS
# =============================================================================

# Enable/disable CORE engine
CORE_ENGINE_ENABLED=true

# Rebalancing frequency: daily, weekly, monthly, quarterly
CORE_REBALANCE_FREQUENCY=quarterly

# Rebalancing threshold (% drift before rebalance)
CORE_REBALANCE_THRESHOLD=0.10

# Target BTC allocation within CORE (66.7%)
CORE_BTC_TARGET=0.667
CORE_BTC_MIN=0.55
CORE_BTC_MAX=0.80

# Target ETH allocation within CORE (33.3%)
CORE_ETH_TARGET=0.333
CORE_ETH_MIN=0.20
CORE_ETH_MAX=0.45

# Yield generation settings
CORE_YIELD_ENABLED=true
CORE_ETH_STAKING_ENABLED=true
CORE_MIN_APY=2.0

# DCA Settings for CORE-HODL
CORE_DCA_INTERVAL_HOURS=168
CORE_DCA_AMOUNT_USDT=100.0

# =============================================================================
# 10. TREND ENGINE SETTINGS
# =============================================================================

# Enable/disable TREND engine
TREND_ENGINE_ENABLED=true

# EMA periods for trend detection
TREND_EMA_FAST_PERIOD=50
TREND_EMA_SLOW_PERIOD=200

# ADX settings
TREND_ADX_PERIOD=14
TREND_ADX_THRESHOLD=25

# ATR settings for stop loss
TREND_ATR_PERIOD=14
TREND_ATR_MULTIPLIER=2.0

# Market allocations within TREND engine
TREND_BTC_PERP_ALLOCATION=0.60
TREND_ETH_PERP_ALLOCATION=0.40

# Trailing stop settings
TREND_TRAILING_STOP_ENABLED=true
TREND_TRAILING_ACTIVATION_R=1.0
TREND_TRAILING_DISTANCE_ATR=3.0

# Risk per trade for trend strategy
TREND_RISK_PER_TRADE=0.01

# Maximum leverage for TREND engine
TREND_MAX_LEVERAGE=2.0

# =============================================================================
# 11. FUNDING ARBITRAGE ENGINE SETTINGS
# =============================================================================

# Enable/disable FUNDING engine
FUNDING_ENGINE_ENABLED=true

# Minimum funding rate threshold (annualized)
FUNDING_MIN_ANNUALIZED_RATE=0.10

# Maximum basis for entry (spot-perp spread)
FUNDING_MAX_BASIS_PCT=0.005

# Rebalancing threshold for hedge deviation
FUNDING_REBALANCE_THRESHOLD=0.02

# Maximum leverage on short leg
FUNDING_MAX_LEVERAGE=2.0

# Margin ratio threshold for warnings
FUNDING_MIN_MARGIN_RATIO=0.30

# Funding rate prediction lookback (hours)
FUNDING_PREDICTION_LOOKBACK=168

# Minimum predicted funding rate for entry (% per 8h)
FUNDING_MIN_PREDICTED_RATE=0.01

# =============================================================================
# 12. TACTICAL ENGINE SETTINGS
# =============================================================================

# Enable/disable TACTICAL engine
TACTICAL_ENGINE_ENABLED=true

# Drawdown triggers for crisis deployment (from ATH)
TACTICAL_TRIGGER_10_PCT_ALLOCATION=0.10
TACTICAL_TRIGGER_20_PCT_ALLOCATION=0.15
TACTICAL_TRIGGER_30_PCT_ALLOCATION=0.20
TACTICAL_TRIGGER_40_PCT_ALLOCATION=0.25
TACTICAL_TRIGGER_50_PCT_ALLOCATION=0.30

# Fear & Greed Index thresholds
TACTICAL_FEAR_GREED_EXTREME_FEAR=20
TACTICAL_FEAR_GREED_FEAR=40
TACTICAL_FEAR_GREED_NEUTRAL=50
TACTICAL_FEAR_GREED_GREED=75
TACTICAL_FEAR_GREED_EXTREME_GREED=80

# Deployment schedule (days to deploy over)
TACTICAL_DEPLOYMENT_DAYS=30

# Maximum reserve deployment (% of reserve fund)
TACTICAL_MAX_DEPLOYMENT_PCT=0.50

# Minimum hold period (days)
TACTICAL_MIN_HOLD_DAYS=90

# Maximum hold period (days)
TACTICAL_MAX_HOLD_DAYS=365

# Profit target for exit (%)
TACTICAL_PROFIT_TARGET_PCT=100.0

# Grid settings for TACTICAL
TACTICAL_GRID_LEVELS=5
TACTICAL_GRID_SPACING_PCT=1.0

# =============================================================================
# 13. DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL database URL
DATABASE_URL=postgresql://user:password@localhost:5432/eternal_engine

# PostgreSQL connection pool settings
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_POOL_TIMEOUT=30

# Redis cache/database URL
REDIS_URL=redis://localhost:6379/0

# Redis connection settings
REDIS_TIMEOUT=5
REDIS_RETRY_ATTEMPTS=3

# SQLite fallback (for development/testing)
SQLITE_URL=sqlite:///./data/eternal_engine.db

# =============================================================================
# 14. MONITORING & ALERTS
# =============================================================================

# Dashboard settings
DASHBOARD_ENABLED=true
DASHBOARD_PORT=8080
DASHBOARD_HOST=0.0.0.0
DASHBOARD_AUTH_ENABLED=true

# Report schedule
REPORT_DAILY_ENABLED=true
REPORT_DAILY_TIME=00:00
REPORT_WEEKLY_ENABLED=true
REPORT_WEEKLY_DAY=sunday
REPORT_MONTHLY_ENABLED=true
REPORT_MONTHLY_DAY=1

# =============================================================================
# 15. TELEGRAM NOTIFICATIONS
# =============================================================================

# Telegram Bot Token (from @BotFather)
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here

# Telegram Chat ID for alerts
TELEGRAM_CHAT_ID=your_chat_id_here

# Notification settings
NOTIFY_ON_TRADE=true
NOTIFY_ON_ERROR=true
NOTIFY_ON_CIRCUIT_BREAKER=true
NOTIFY_LEVEL_1=false
NOTIFY_LEVEL_2=true
NOTIFY_LEVEL_3=true
NOTIFY_LEVEL_4=true

# =============================================================================
# 16. EMAIL NOTIFICATIONS (SMTP)
# =============================================================================

# SMTP server configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASSWORD=your_app_password_here
SMTP_USE_TLS=true

# Email recipients (comma-separated)
EMAIL_ALERT_RECIPIENTS=admin@example.com,ops@example.com

# Email notification settings
EMAIL_ON_CRITICAL=true
EMAIL_ON_CIRCUIT_BREAKER=true
EMAIL_ON_DAILY_REPORT=false

# =============================================================================
# 17. WEBHOOK NOTIFICATIONS
# =============================================================================

# Webhook URL for external integrations (Discord, Slack, etc.)
WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Webhook timeout and retry
WEBHOOK_TIMEOUT=10
WEBHOOK_RETRY_ATTEMPTS=3

# =============================================================================
# 18. SECURITY SETTINGS
# =============================================================================

# Encryption key for sensitive data (generate with: openssl rand -hex 32)
ENCRYPTION_KEY=your_32_byte_encryption_key_here

# JWT secret for API authentication
JWT_SECRET=your_jwt_secret_key_here_min_32_chars_long
JWT_EXPIRY_HOURS=24

# IP Whitelist for dashboard/API access (comma-separated CIDR notation)
# Leave empty to disable
IP_WHITELIST=127.0.0.1/32,10.0.0.0/8,192.168.0.0/16

# Dual authorization for critical actions
DUAL_AUTH_ENABLED=true
DUAL_AUTH_OPERATORS=operator1@example.com,operator2@example.com

# =============================================================================
# 19. STOP LOSS & TAKE PROFIT SETTINGS
# =============================================================================

# Enable/disable automatic stop loss
ENABLE_STOP_LOSS=true
STOP_LOSS_PCT=3.0
STOP_LOSS_ATR_MULTIPLIER=2.0

# Enable/disable automatic take profit
ENABLE_TAKE_PROFIT=true
TAKE_PROFIT_PCT=6.0

# Tiered take profit levels
TAKE_PROFIT_TIER1_PCT=1.5
TAKE_PROFIT_TIER1_SIZE=0.30
TAKE_PROFIT_TIER2_PCT=3.0
TAKE_PROFIT_TIER2_SIZE=0.40
TAKE_PROFIT_TIER3_PCT=5.0
TAKE_PROFIT_TIER3_SIZE=0.30

# =============================================================================
# 20. CORRELATION & LIQUIDITY MONITORING
# =============================================================================

# Correlation monitoring settings
CORRELATION_LOOKBACK_DAYS=30
CORRELATION_CRISIS_THRESHOLD=0.75
CORRELATION_EMERGENCY_THRESHOLD=0.90

# Liquidity risk settings
MIN_ORDERBOOK_DEPTH_USD=100000
MAX_SLIPPAGE_PCT=0.5

# Flash crash protection
FLASH_CRASH_PRICE_DROP_PCT=5.0
FLASH_CRASH_DEPTH_DROP_PCT=50.0
FLASH_CRASH_SPREAD_MULTIPLIER=3.0

# =============================================================================
# 21. LOGGING CONFIGURATION
# =============================================================================

# Log file settings
LOG_FILE=logs/eternal_engine.log
LOG_FILE_MAX_SIZE_MB=100
LOG_FILE_BACKUP_COUNT=10

# Audit log for critical actions
AUDIT_LOG_ENABLED=true
AUDIT_LOG_FILE=logs/audit.log

# External log aggregation (optional)
# SPLUNK_URL=https://splunk.example.com
# SPLUNK_TOKEN=your_splunk_token

# =============================================================================
# 22. BACKUP & RECOVERY
# =============================================================================

# Backup settings
BACKUP_ENABLED=true
BACKUP_INTERVAL_HOURS=24
BACKUP_RETENTION_DAYS=30
BACKUP_LOCATION=/backups/eternal_engine

# =============================================================================
# 23. DEVELOPMENT & TESTING
# =============================================================================

# Testnet specific settings
TESTNET_INITIAL_BALANCE_USDT=100000

# Paper trading settings
PAPER_INITIAL_BALANCE_USDT=100000

# Feature flags for development
FEATURE_FLAG_GRID_TRADING=false
FEATURE_FLAG_ML_PREDICTIONS=false

# =============================================================================
# END OF CONFIGURATION
# =============================================================================
# Remember to:
# 1. Copy this file to .env
# 2. Replace all placeholder values
# 3. Generate strong encryption keys
# 4. Set up proper API key permissions on Bybit
# 5. Test in paper mode before going live
# =============================================================================
